
<TabPanel>
    <Tabs>
        <TabPanelItem Title="Customer">
            <CaspianForm @ref="Page.Form" Model="Page.UpsertData">
                <CaspianValidationValidator ValidatorType="typeof(CustomerAndAddressService)" />
                <div class="row p-4 c-controls">
                    <div class="col-md-4">
                        <label>Customer Type</label>
                    </div>
                    <div class="col-md-8">
                        <DropdownList @bind-Value="Page.UpsertData.CustomerType" />
                    </div>
                    <div class="col-md-4">
                        <label>First Name</label>
                    </div>
                    <div class="col-md-8">
                        <StringTextBox @bind-Value="Page.UpsertData.FName"
                                       Disabled="Page.UpsertData.CustomerType == CustomerType.Legal" />
                    </div>
                    <div class="col-md-4">
                        <label>Last Name</label>
                    </div>
                    <div class="col-md-8">
                        <StringTextBox @bind-Value="Page.UpsertData.LName"
                                       Disabled="Page.UpsertData.CustomerType == CustomerType.Legal" />
                    </div>
                    <div class="col-md-4">
                        <label>Gender</label>
                    </div>
                    <div class="col-md-8">
                        <DropdownList @bind-Value="Page.UpsertData.Gender"
                                      Disabled="Page.UpsertData.CustomerType == CustomerType.Legal" />
                    </div>
                    <div class="col-md-4">
                        <label>Company Name</label>
                    </div>
                    <div class="col-md-8">
                        <StringTextBox @bind-Value="Page.UpsertData.CompanyName"
                                       Disabled="Page.UpsertData.CustomerType == CustomerType.Real" />
                    </div>
                    <div class="col-md-4">
                        <label>Mobile Number</label>
                    </div>
                    <div class="col-md-8">
                        <StringTextBox @bind-Value="Page.UpsertData.MobileNumber" MaxLength="11" />
                    </div>
                    <div class="col-md-4">
                        <label>Tel</label>
                    </div>
                    <div class="col-md-8">
                        <StringTextBox @bind-Value="Page.UpsertData.Tel" MaxLength="11" />
                    </div>
                    <div class="col-md-4"></div>
                    <div class="col-md-8">
                        <FormCommandButton />
                    </div>
                </div>
            </CaspianForm>
        </TabPanelItem>
        <TabPanelItem Title="Addresses">
            <div class="p-2">
                <DataGrid @ref="Page.DataView" TEntity="CustomerAddress" ChangedEntities="Page.ChangedEntities" ContentHeight="300" Inline Batch ConditionExpr="t => t.CustomerId == Page.MasterId">
                    <Columns Context="con">
                        <GridColumn style="width:220px;" Field="t => t.AddressType.Title" Title="Address Type">
                            <EditTemplate>
                                <ComboBox TValue="int" TEntity="AddressType" @bind-Value="con.Data.AddressTypeId" TextExpression="t => t.Title" />
                            </EditTemplate>
                        </GridColumn>
                        <GridColumn Field="t => t.Address" Title="Address">
                            <EditTemplate>
                                <StringTextBox MultiLine Rows="2" @bind-Value="con.Data.Address" />
                            </EditTemplate>
                        </GridColumn>
                        <GridColumn Field="t => t.ZipCode" Title="Zipcode" style="width:120px">
                            <EditTemplate>
                                <StringTextBox @bind-Value="con.Data.ZipCode" />
                            </EditTemplate>
                        </GridColumn>
                        <GridCommandColumns />
                    </Columns>
                </DataGrid>
            </div>
        </TabPanelItem>
    </Tabs>
</TabPanel>

@code 
{
    [Parameter]
    public MasterDetailPage<Customer, CustomerAddress> Page { get; set; }
}
