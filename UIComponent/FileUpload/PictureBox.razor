@namespace Caspian.UI
<div @attributes="Attributes" class="c-picturebox">
    <span class="c-content" @ref="span">
        @(Data == null ? NoContentTitle : "")
    </span>
</div>
@code
{
    ElementReference span;

    [Inject]
    IJSRuntime jsRuntime { get; set; }

    [Parameter]
    public string NoContentTitle { get; set; }

    [Parameter(CaptureUnmatchedValues = true)]
    public IDictionary<string, object> Attributes { get; set; }

    [CascadingParameter(Name = "ParentForm"), JsonIgnore]
    internal ICaspianForm CaspianForm { get; set; }

    [Parameter]
    public byte[] Data { get; set; }

    [Parameter]
    public string ContentType{ get; set; }

    protected async override Task OnAfterRenderAsync(bool firstRender)
    {
        if (Data != null)
        {
            var data = Convert.ToBase64String(Data);
            await jsRuntime.InvokeVoidAsync("$.telerik.bindImage", span, data, ContentType);
        }
        else
            await jsRuntime.InvokeVoidAsync("$.telerik.bindImage", span, null);
        await base.OnAfterRenderAsync(firstRender);
    }
}
