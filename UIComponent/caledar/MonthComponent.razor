@namespace Caspian.UI
@inject CaspianDataService service

<table class="t-content">
    <tr class="t-week-header">
        @foreach (var item in WeekDays)
        {
            <th>@item</th>
        }
    </tr>
    @for (int i = 0; i < 6; i++)
    {
        <tr>
            @for (int j = 0; j < 7; j++)
            {
                var day = MonthDays[i, j];
                if (i == 0 && day > 10 || i >= 4 && day < 10)
                {
                    <td class="t-other-month">@day</td>
                }
                else
                {
                    string className = Date.Day == day ? "t-state-selected" : "";
                    <td class="@className">@day</td>
                }
            }
        </tr>

    }
</table>
@code
{
    string[] WeekDays;
    int[,] MonthDays;

    protected override void OnInitialized()
    {
        if (service.Language == Language.En)
            WeekDays = new string[7] { "Su", "Mo", "Tu", "We", "Th", "Fr", "Sa" };
        else
            WeekDays = new string[7] { "ش", "ی", "د", "س", "چ", "پ", "ج" };
        base.OnInitialized();
    }

    protected override void OnParametersSet()
    {
        if (service.Language == Language.En)
        {
            MonthDays = new int[6, 7];
            var date = Date.FirstDayInCalendar();
            for (int i = 0; i < 6; i++)
                for (int j = 0; j < 7; j++)
                {
                    MonthDays[i, j] = date.Day;
                    date = date.AddDays(1);
                }
        }
        else
        {

        }
        base.OnParametersSet();
    }

    [Parameter]
    public DateTime Date { get; set; }
}
