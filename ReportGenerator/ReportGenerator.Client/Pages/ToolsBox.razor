@namespace Caspian.Report
<div class="r-toolsbox">
    <span @onmousedown="AddControl" class="tools textbox" title="متن"></span>
    <span @onmousedown="AddTable" class="tools picture" title="تصویر"></span>
    <span class="tools subreport" title="گزارش فرعی"></span>
    <span class="tools table" title="جدول"></span>
    <span class="tools checkbox" title="check box"></span>
    <span class="tools chart" title="نمودار"></span>
</div>

@code 
{
    async Task AddControl(MouseEventArgs e)
    {
        var control = new ControlData(e.ClientX, e.ClientY);
        control.Width = 180;
        control.Height = 32;
        await Page.AddControl(control);
    }

    async Task AddTable(MouseEventArgs e)
    {
        var table = GetTableData(Page.Bound.Data.ColumnCount);
        await Page.AddTable(table);
    }

    TableData GetTableData(int columnCount)
    {
        var table = new TableData();
        table.HeaderCells = new List<HeaderCellData>()
            {
                new HeaderCellData(){Width = 100},
                new HeaderCellData(){Width = 150},
            };
        if (columnCount < 2)
        {
            table.HeaderCells.Add(new HeaderCellData() { Width = 200 });
            table.HeaderCells.Add(new HeaderCellData() { Width = 200 });
        }
        table.Rows = new List<TableRowData>();
        var row = new TableRowData();
        row.RowIndex = 1;
        for (var colIndex = 1; colIndex <= table.HeaderCells.Count; colIndex++)
        {
            row.Cells.Add(new TableCellData(row)
                {
                    ColIndex = colIndex
                });
        }
        table.Rows.Add(row);
        return table;
    }

    [Parameter]
    public Page Page { get; set; }
}
